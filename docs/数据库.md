# 数据库表结构

#### 1. 用户表 (`users`)
存储注册用户信息，管理端用户也包含在内。
| 字段            | 类型                    | 约束                                                    | 描述     |
| :-------------- | :---------------------- | :------------------------------------------------------ | :------- |
| `id`            | `INT`                   | `PRIMARY KEY, AUTO_INCREMENT`                           | 代理主键 |
| `username`      | `VARCHAR(50)`           | `UNIQUE, NOT NULL`                                      | 用户名   |
| `email`         | `VARCHAR(100)`          | `UNIQUE, NOT NULL`                                      | 邮箱     |
| `password_hash` | `VARCHAR(255)`          | `NOT NULL`                                              | 密码哈希 |
| `nickname`      | `VARCHAR(100)`          |                                                         | 昵称     |
| `avatar_url`    | `VARCHAR(255)`          |                                                         | 头像URL  |
| `bio`           | `TEXT`                  |                                                         | 个人简介 |
| `role`          | `ENUM('user', 'admin')` | `DEFAULT 'user'`                                        | 用户角色 |
| `is_active`     | `BOOLEAN`               | `DEFAULT TRUE`                                          | 是否激活 |
| `created_at`    | `TIMESTAMP`             | `DEFAULT CURRENT_TIMESTAMP`                             | 创建时间 |
| `updated_at`    | `TIMESTAMP`             | `DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | 更新时间 |

#### 2. 文章表 (`posts`)
存储文章的基本信息，正文内容路径存储在此。
| 字段                | 类型                                     | 约束                                                    | 描述                       |
| :------------------ | :--------------------------------------- | :------------------------------------------------------ | :------------------------- |
| `id`                | `INT`                                    | `PRIMARY KEY, AUTO_INCREMENT`                           | 代理主键                   |
| `title`             | `VARCHAR(255)`                           | `NOT NULL`                                              | 文章标题                   |
| `summary`           | `TEXT`                                   |                                                         | 文章摘要                   |
| `cover_image_url`   | `VARCHAR(255)`                           |                                                         | 封面图片URL                |
| `content_file_path` | `VARCHAR(500)`                           | `NOT NULL`                                              | 文章正文内容文件的存储路径 |
| `author_id`         | `INT`                                    | `NOT NULL`                                              | 作者ID                     |
| `status`            | `ENUM('draft', 'published', 'archived')` | `DEFAULT 'draft'`                                       | 文章状态                   |
| `view_count`        | `INT`                                    | `DEFAULT 0`                                             | 阅读量                     |
| `like_count`        | `INT`                                    | `DEFAULT 0`                                             | 点赞数                     |
| `published_at`      | `TIMESTAMP`                              | `NULL`                                                  | 发布时间                   |
| `created_at`        | `TIMESTAMP`                              | `DEFAULT CURRENT_TIMESTAMP`                             | 创建时间                   |
| `updated_at`        | `TIMESTAMP`                              | `DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | 更新时间                   |

#### 3. 分类表 (`categories`)
用于对文章进行分类。
| 字段          | 类型           | 约束                                                    | 描述     |
| :------------ | :------------- | :------------------------------------------------------ | :------- |
| `id`          | `INT`          | `PRIMARY KEY, AUTO_INCREMENT`                           | 代理主键 |
| `name`        | `VARCHAR(100)` | `UNIQUE, NOT NULL`                                      | 分类名称 |
| `description` | `TEXT`         |                                                         | 分类描述 |
| `created_at`  | `TIMESTAMP`    | `DEFAULT CURRENT_TIMESTAMP`                             | 创建时间 |
| `updated_at`  | `TIMESTAMP`    | `DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | 更新时间 |

#### 4. 标签表 (`tags`)
用于给文章打标签。
| 字段         | 类型          | 约束                                                    | 描述     |
| :----------- | :------------ | :------------------------------------------------------ | :------- |
| `id`         | `INT`         | `PRIMARY KEY, AUTO_INCREMENT`                           | 代理主键 |
| `name`       | `VARCHAR(50)` | `UNIQUE, NOT NULL`                                      | 标签名称 |
| `created_at` | `TIMESTAMP`   | `DEFAULT CURRENT_TIMESTAMP`                             | 创建时间 |
| `updated_at` | `TIMESTAMP`   | `DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | 更新时间 |

#### 5. 文章-分类关联表 (`post_categories`)
实现文章与分类的多对多关系。
| 字段          | 类型  | 约束                                 | 描述     |
| :------------ | :---- | :----------------------------------- | :------- |
| `post_id`     | `INT` | `NOT NULL`                           | 文章ID   |
| `category_id` | `INT` | `NOT NULL`                           | 分类ID   |
|               |       | `PRIMARY KEY (post_id, category_id)` | 组合主键 |

#### 6. 文章-标签关联表 (`post_tags`)
实现文章与标签的多对多关系。
| 字段      | 类型  | 约束                            | 描述     |
| :-------- | :---- | :------------------------------ | :------- |
| `post_id` | `INT` | `NOT NULL`                      | 文章ID   |
| `tag_id`  | `INT` | `NOT NULL`                      | 标签ID   |
|           |       | `PRIMARY KEY (post_id, tag_id)` | 组合主键 |

#### 7. 评论表 (`comments`)
存储所有评论，包括用户评论和匿名评论。
| 字段             | 类型                                              | 约束                                                    | 描述                            |
| :--------------- | :------------------------------------------------ | :------------------------------------------------------ | :------------------------------ |
| `id`             | `INT`                                             | `PRIMARY KEY, AUTO_INCREMENT`                           | 代理主键                        |
| `post_id`        | `INT`                                             | `NOT NULL`                                              | 评论的文章ID                    |
| `author_user_id` | `INT`                                             |                                                         | 评论者用户ID (NULL表示匿名评论) |
| `author_name`    | `VARCHAR(100)`                                    |                                                         | 匿名评论者姓名                  |
| `author_email`   | `VARCHAR(100)`                                    |                                                         | 匿名评论者邮箱                  |
| `content`        | `TEXT`                                            | `NOT NULL`                                              | 评论内容                        |
| `parent_id`      | `INT`                                             |                                                         | 父评论ID (用于实现回复)         |
| `status`         | `ENUM('pending', 'approved', 'spam', 'rejected')` | `DEFAULT 'pending'`                                     | 评论状态                        |
| `created_at`     | `TIMESTAMP`                                       | `DEFAULT CURRENT_TIMESTAMP`                             | 创建时间                        |
| `updated_at`     | `TIMESTAMP`                                       | `DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | 更新时间                        |

#### 8. 点赞表 (`likes`)
记录用户和访客对文章的点赞信息。
| 字段                 | 类型           | 约束                          | 描述                            |
| :------------------- | :------------- | :---------------------------- | :------------------------------ |
| `id`                 | `BIGINT`       | `PRIMARY KEY, AUTO_INCREMENT` | 代理主键                        |
| `post_id`            | `INT`          | `NOT NULL`                    | 被点赞的文章ID                  |
| `user_id`            | `INT`          |                               | 点赞的注册用户ID (NULL表示访客) |
| `visitor_identifier` | `VARCHAR(255)` |                               | 访客标识 (如IP或生成的UUID)     |
| `created_at`         | `TIMESTAMP`    | `DEFAULT CURRENT_TIMESTAMP`   | 创建时间                        |

